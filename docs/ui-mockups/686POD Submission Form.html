<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proof of Delivery Submission</title>
    <style>
        /* CSS Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Design System Tokens */
        :root {
            /* Typography */
            --font-family-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --font-size-body: 16px;
            --font-size-h1: 28px;
            --font-size-h2: 20px;
            --font-size-caption: 14px;
            --font-weight-normal: 400;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;

            /* Colors */
            --color-primary-50: #EFF6FF;
            --color-primary-100: #DBEAFE;
            --color-primary-600: #2563EB;
            --color-primary-700: #1D4ED8;
            --color-gray-50: #F9FAFB;
            --color-gray-100: #F3F4F6;
            --color-gray-300: #D1D5DB;
            --color-gray-500: #6B7280;
            --color-gray-700: #374151;
            --color-gray-900: #111827;
            --color-white: #FFFFFF;
            --color-error-50: #FEF2F2;
            --color-error-500: #EF4444;
            --color-error-700: #B91C1C;
            --color-success-50: #F0FDF4;
            --color-success-700: #15803D;

            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;

            /* Borders */
            --border-radius-md: 8px;

            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        /* Base Styles */
        html, body {
            font-family: var(--font-family-primary);
            background-color: var(--color-gray-50);
            color: var(--color-gray-900);
            line-height: 1.6;
        }
        
        /* Screen Layout */
        .screen-container {
            max-width: 480px;
            margin: 0 auto;
            padding: var(--space-lg);
            min-height: 100vh;
        }

        .screen-header {
            margin-bottom: var(--space-lg);
            border-bottom: 1px solid var(--color-gray-300);
            padding-bottom: var(--space-md);
        }

        .screen-header h1 {
            font-size: var(--font-size-h1);
            font-weight: var(--font-weight-bold);
            line-height: 1.2;
        }

        .screen-header .trip-id {
            font-size: var(--font-size-caption);
            color: var(--color-gray-500);
            font-weight: var(--font-weight-normal);
        }

        /* Form & Component Styles */
        .pod-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }
        
        /* Tab/Choice Component */
        .pod-method-chooser {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-sm);
            background-color: var(--color-gray-100);
            padding: var(--space-xs);
            border-radius: var(--border-radius-md);
        }
        .pod-method-chooser__tab {
            font-family: inherit;
            font-size: var(--font-size-body);
            font-weight: var(--font-weight-semibold);
            padding: var(--space-sm) var(--space-md);
            border: none;
            background-color: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            color: var(--color-gray-700);
        }
        .pod-method-chooser__tab:focus-visible {
            outline: 2px solid var(--color-primary-600);
            outline-offset: 2px;
        }
        .pod-method-chooser__tab[aria-selected="true"] {
            background-color: var(--color-white);
            color: var(--color-primary-700);
            box-shadow: var(--shadow-sm);
        }
        .pod-method-chooser__tab:disabled {
            color: var(--color-gray-300);
            cursor: not-allowed;
        }

        /* Panels for methods */
        .pod-method-panel {
            border: 1px solid var(--color-gray-300);
            border-radius: var(--border-radius-md);
            background-color: var(--color-white);
        }
        .pod-method-panel[hidden] {
            display: none;
        }

        /* File Uploader Component */
        .file-uploader {
            padding: var(--space-lg);
            text-align: center;
        }
        .file-uploader__label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-xl);
            border: 2px dashed var(--color-gray-300);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: border-color 0.2s;
        }
        .file-uploader__label:hover {
            border-color: var(--color-primary-600);
        }
        .file-uploader__input {
            width: 0.1px;
            height: 0.1px;
            opacity: 0;
            overflow: hidden;
            position: absolute;
            z-index: -1;
        }
        .file-uploader__icon {
            width: 48px;
            height: 48px;
            color: var(--color-gray-500);
            margin-bottom: var(--space-md);
        }
        .file-uploader__text {
            font-weight: var(--font-weight-semibold);
            color: var(--color-primary-700);
        }
        .file-uploader__hint {
            font-size: var(--font-size-caption);
            color: var(--color-gray-500);
        }
        .file-uploader__preview {
            margin-top: var(--space-md);
            max-width: 100%;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-md);
        }
        .file-uploader__preview[hidden] {
            display: none;
        }

        /* Signature Pad Component */
        .signature-pad {
            padding: var(--space-sm);
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        .signature-pad__canvas {
            width: 100%;
            height: 200px;
            background-color: var(--color-gray-100);
            border-radius: 6px;
            cursor: crosshair;
        }
        .signature-pad__actions {
            display: flex;
            justify-content: flex-end;
        }
        .signature-pad__clear-btn {
            font-family: inherit;
            font-size: var(--font-size-caption);
            padding: var(--space-xs) var(--space-sm);
            border: 1px solid var(--color-gray-300);
            background-color: var(--color-white);
            color: var(--color-gray-700);
            border-radius: 6px;
            cursor: pointer;
        }

        /* Form Input Component */
        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        .form-group__label {
            font-weight: var(--font-weight-semibold);
        }
        .form-group__input {
            font-family: inherit;
            font-size: var(--font-size-body);
            padding: 10px 14px;
            border: 1px solid var(--color-gray-300);
            border-radius: var(--border-radius-md);
            background-color: var(--color-white);
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-group__input:focus {
            outline: none;
            border-color: var(--color-primary-600);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }
        .form-group__input.has-error {
            border-color: var(--color-error-500);
        }
        .form-group__error-text {
            font-size: var(--font-size-caption);
            color: var(--color-error-700);
            display: none;
        }
        .has-error + .form-group__error-text {
            display: block;
        }

        /* Large Action Button */
        .action-button {
            font-family: inherit;
            font-size: 18px;
            font-weight: var(--font-weight-bold);
            color: var(--color-white);
            background-color: var(--color-primary-600);
            border: none;
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: background-color 0.2s;
            width: 100%;
        }
        .action-button:hover {
            background-color: var(--color-primary-700);
        }
        .action-button:disabled {
            background-color: var(--color-primary-100);
            cursor: not-allowed;
        }

        /* Loading/Submitting State */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .is-submitting .loading-overlay {
            opacity: 1;
            visibility: visible;
        }
        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--color-primary-100);
            border-top-color: var(--color-primary-600);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Screen Variations Section */
        .screen-variations {
            margin-top: var(--space-xl);
            padding-top: var(--space-xl);
            border-top: 2px dashed var(--color-gray-300);
        }
        .screen-variations h2 {
            font-size: var(--font-size-h2);
            margin-bottom: var(--space-lg);
        }
        .variation-group {
            margin-bottom: var(--space-xl);
            padding: var(--space-lg);
            border: 1px solid var(--color-gray-300);
            border-radius: var(--border-radius-md);
            background-color: var(--color-white);
        }
        .variation-group h3 {
            font-size: var(--font-size-h2);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--space-sm);
        }
        .variation-group .description {
            font-size: var(--font-size-caption);
            color: var(--color-gray-500);
            margin-bottom: var(--space-md);
            font-style: italic;
        }
        
        /* Error Alert */
        .alert {
            padding: var(--space-md);
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        .alert--error {
            background-color: var(--color-error-50);
            color: var(--color-error-700);
        }
        .alert__icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }
        .alert__text {
            font-weight: var(--font-weight-semibold);
        }

    </style>
</head>
<body id="main-body">

    <div class="screen-container" id="default-form">
        <header class="screen-header">
            <h1>Proof of Delivery</h1>
            <p class="trip-id">For Trip ID: TRP-2025-001</p>
        </header>

        <main>
            <form class="pod-form" id="pod-form-main" onsubmit="handleSubmit(event)">
                <div class="form-group">
                    <label class="form-group__label">Select POD Method</label>
                    <div class="pod-method-chooser" role="tablist">
                        <button type="button" class="pod-method-chooser__tab" role="tab" aria-selected="true" aria-controls="photo-panel" id="photo-tab">Upload Photo</button>
                        <button type="button" class="pod-method-chooser__tab" role="tab" aria-selected="false" aria-controls="signature-panel" id="signature-tab">E-Signature</button>
                    </div>
                </div>

                <div class="pod-method-panel" id="photo-panel" role="tabpanel" aria-labelledby="photo-tab">
                    <div class="file-uploader">
                        <label for="file-upload" class="file-uploader__label">
                             <svg class="file-uploader__icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" /><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" /></svg>
                             <span class="file-uploader__text">Tap to Upload Photo</span>
                             <span class="file-uploader__hint">JPG or PNG, max 5MB</span>
                        </label>
                        <input type="file" id="file-upload" class="file-uploader__input" accept="image/png, image/jpeg">
                        <img id="image-preview" class="file-uploader__preview" src="" alt="Image preview" hidden>
                    </div>
                </div>

                <div class="pod-method-panel" id="signature-panel" role="tabpanel" aria-labelledby="signature-tab" hidden>
                    <div class="signature-pad">
                        <canvas class="signature-pad__canvas" id="signature-canvas"></canvas>
                        <div class="signature-pad__actions">
                            <button type="button" class="signature-pad__clear-btn" id="clear-signature">Clear</button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="recipient-name" class="form-group__label">Recipient's Name</label>
                    <input type="text" id="recipient-name" class="form-group__input" placeholder="Enter full name" required>
                    <p class="form-group__error-text" id="recipient-error">Recipient name is required.</p>
                </div>
                
                <button type="submit" class="action-button">Submit Proof of Delivery</button>
            </form>
        </main>
    </div>

    <!-- Loading Overlay for submission state -->
    <div class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <!-- Screen Variations -->
    <div class="screen-variations">
        <h2>Screen Variations</h2>

        <div class="variation-group">
            <h3>Variant Name: "Default State"</h3>
            <p class="description">The initial view of the form, ready for user input. The user can toggle between 'Photo' and 'Signature' methods.</p>
            <!-- The main screen above serves as the default state demonstration -->
        </div>

        <div class="variation-group">
            <h3>Variant Name: "Submitting State"</h3>
            <p class="description">Shown after the user clicks 'Submit'. The form is disabled, and a loading overlay with a spinner indicates that the data is being processed.</p>
             <div style="position: relative; overflow: hidden;">
                <div class="screen-container">
                    <!-- A static version of the form for display -->
                     <header class="screen-header"><h1>Proof of Delivery</h1><p class="trip-id">For Trip ID: TRP-2025-001</p></header>
                     <form class="pod-form"><div class="form-group"><label class="form-group__label">Select POD Method</label><div class="pod-method-chooser"><button type="button" class="pod-method-chooser__tab" disabled>Upload Photo</button><button type="button" class="pod-method-chooser__tab" disabled>E-Signature</button></div></div><div class="pod-method-panel"><div class="file-uploader"><label class="file-uploader__label" style="cursor: not-allowed; border-color: var(--color-gray-100);"><svg class="file-uploader__icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" /><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" /></svg><span class="file-uploader__text">Tap to Upload Photo</span><span class="file-uploader__hint">JPG or PNG, max 5MB</span></label></div></div><div class="form-group"><label class="form-group__label">Recipient's Name</label><input type="text" class="form-group__input" value="John Smith" disabled></div><button type="submit" class="action-button" disabled>Submit Proof of Delivery</button></form>
                </div>
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(255, 255, 255, 0.8); display: flex; align-items: center; justify-content: center; z-index: 10;"><div class="spinner"></div></div>
            </div>
        </div>

        <div class="variation-group">
            <h3>Variant Name: "Error State"</h3>
            <p class="description">Displays when validation fails (e.g., recipient name is missing) or when a server-side submission error occurs.</p>
            <div class="screen-container" style="background-color: var(--color-white);">
                <header class="screen-header"><h1>Proof of Delivery</h1><p class="trip-id">For Trip ID: TRP-2025-001</p></header>
                <form class="pod-form">
                    <div class="alert alert--error">
                         <svg class="alert__icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" /></svg>
                         <span class="alert__text">Submission failed. Please check your network.</span>
                    </div>
                    <div class="form-group"><label class="form-group__label">Select POD Method</label><div class="pod-method-chooser"><button type="button" class="pod-method-chooser__tab" aria-selected="true">Upload Photo</button><button type="button" class="pod-method-chooser__tab" aria-selected="false">E-Signature</button></div></div>
                    <div class="pod-method-panel"><div class="file-uploader">...</div></div>
                    <div class="form-group">
                        <label for="recipient-name-error" class="form-group__label">Recipient's Name</label>
                        <input type="text" id="recipient-name-error" class="form-group__input has-error" value="">
                        <p class="form-group__error-text" style="display: block;">Recipient name is required.</p>
                    </div>
                    <button type="submit" class="action-button">Submit Proof of Delivery</button>
                </form>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('[role="tab"]');
            const panels = document.querySelectorAll('[role="tabpanel"]');
            
            // Tab switching logic
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
                    tab.setAttribute('aria-selected', 'true');
                    
                    panels.forEach(panel => {
                        if (panel.getAttribute('aria-labelledby') === tab.id) {
                            panel.removeAttribute('hidden');
                        } else {
                            panel.setAttribute('hidden', '');
                        }
                    });
                });
            });

            // File preview logic
            const fileInput = document.getElementById('file-upload');
            const preview = document.getElementById('image-preview');
            fileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    preview.src = URL.createObjectURL(file);
                    preview.removeAttribute('hidden');
                }
            });

            // Signature Pad logic
            const canvas = document.getElementById('signature-canvas');
            const clearButton = document.getElementById('clear-signature');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let drawing = false;

                const getPosition = (event) => {
                    const rect = canvas.getBoundingClientRect();
                    const touch = event.touches ? event.touches[0] : event;
                    return {
                        x: (touch.clientX - rect.left) * (canvas.width / rect.width),
                        y: (touch.clientY - rect.top) * (canvas.height / rect.height)
                    };
                };

                const startDrawing = (event) => {
                    event.preventDefault();
                    drawing = true;
                    const { x, y } = getPosition(event);
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                };

                const draw = (event) => {
                    if (!drawing) return;
                    event.preventDefault();
                    const { x, y } = getPosition(event);
                    ctx.lineTo(x, y);
                    ctx.strokeStyle = 'black';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                };

                const stopDrawing = () => {
                    drawing = false;
                    ctx.closePath();
                };
                
                // Adjust canvas resolution
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;

                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseleave', stopDrawing);

                canvas.addEventListener('touchstart', startDrawing);
                canvas.addEventListener('touchmove', draw);
                canvas.addEventListener('touchend', stopDrawing);
                
                clearButton.addEventListener('click', () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                });
            }
        });

        // Form submission simulation
        function handleSubmit(event) {
            event.preventDefault();
            const recipientInput = document.getElementById('recipient-name');
            const recipientError = document.getElementById('recipient-error');

            // Basic validation
            let isValid = true;
            if (recipientInput.value.trim() === '') {
                recipientInput.classList.add('has-error');
                recipientError.style.display = 'block';
                isValid = false;
            } else {
                recipientInput.classList.remove('has-error');
                recipientError.style.display = 'none';
            }
            
            if (!isValid) return;

            // Show submitting state
            const body = document.getElementById('main-body');
            body.classList.add('is-submitting');

            // Simulate network request
            setTimeout(() => {
                body.classList.remove('is-submitting');
                // On a real app, you would handle the success/error response here.
                // For this mockup, we'll just show an alert.
                alert('Success! POD Submitted. (This is a mockup)');
                event.target.reset();
                document.getElementById('image-preview').setAttribute('hidden', '');
                const canvas = document.getElementById('signature-canvas');
                 if(canvas) {
                    const ctx = canvas.getContext('2d');
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            }, 2000);
        }
    </script>

</body>
</html>